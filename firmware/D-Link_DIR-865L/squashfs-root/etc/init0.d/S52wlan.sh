#!/bin/sh

xmldbc -P /etc/services/WIFI/rtcfg.php -V ACTION="INIT" > /var/init_wifi_mod.sh

# init wireless power 
# 2.4 G
nvram set pci/2/1/maxp2ga0=0x64
nvram set pci/2/1/maxp2ga1=0x64
nvram set pci/2/1/maxp2ga2=0x64
nvram set pci/2/1/cckbw202gpo=0x7777
nvram set pci/2/1/cckbw20ul2gpo=0x7777
nvram set pci/2/1/legofdmbw202gpo=0x55111111
nvram set pci/2/1/legofdmbw20ul2gpo=0x55111111
nvram set pci/2/1/mcsbw202gpo=0x55111111
nvram set pci/2/1/mcsbw20ul2gpo=0x55111111
nvram set pci/2/1/mcsbw402gpo=0x99999999

nvram set pci/2/1/pa2gw0a0=0xFE61
nvram set pci/2/1/pa2gw1a0=0x1E65
nvram set pci/2/1/pa2gw2a0=0xF89E
nvram set pci/2/1/pa2gw0a1=0xFE5F
nvram set pci/2/1/pa2gw1a1=0x1DA5
nvram set pci/2/1/pa2gw2a1=0xF8C3
nvram set pci/2/1/pa2gw0a2=0xFE50
nvram set pci/2/1/pa2gw1a2=0x1D68
nvram set pci/2/1/pa2gw2a2=0xF8B7

# 5 G
nvram set pci/1/1/sromrev=11
nvram set pci/1/1/boardrev=0x1307
nvram set pci/1/1/boardflags=0x10000000
nvram set pci/1/1/boardflags2=0x300002
nvram set pci/1/1/boardtype=0x621
nvram set pci/1/1/boardflags3=0x300030
nvram set pci/1/1/boardnum=0
nvram set pci/1/1/macaddr=00:90:4c:d4:00:00
nvram set pci/1/1/ccode=Q1
nvram set pci/1/1/regrev=27
nvram set pci/1/1/aa2g=0
nvram set pci/1/1/aa5g=7
nvram set pci/1/1/agbg0=71
nvram set pci/1/1/agbg1=71
nvram set pci/1/1/agbg2=133
nvram set pci/1/1/aga0=71
nvram set pci/1/1/aga1=133
nvram set pci/1/1/aga2=133
nvram set pci/1/1/txchain=7
nvram set pci/1/1/rxchain=7
nvram set pci/1/1/antswitch=0
nvram set pci/1/1/tssiposslope2g=1
nvram set pci/1/1/epagain2g=0
nvram set pci/1/1/pdgain2g=4
nvram set pci/1/1/tworangetssi2g=0
nvram set pci/1/1/papdcap2g=0
nvram set pci/1/1/femctrl=3
nvram set pci/1/1/tssiposslope5g=1
nvram set pci/1/1/epagain5g=0
nvram set pci/1/1/pdgain5g=4
nvram set pci/1/1/tworangetssi5g=0
nvram set pci/1/1/papdcap5g=0
nvram set pci/1/1/gainctrlsph=0
nvram set pci/1/1/tempthresh=255
nvram set pci/1/1/tempoffset=255
nvram set pci/1/1/rawtempsense=0x1ff
nvram set pci/1/1/measpower=0x7f
nvram set pci/1/1/tempsense_slope=0xff
nvram set pci/1/1/tempcorrx=0x3f
nvram set pci/1/1/tempsense_option=0x3
nvram set pci/1/1/phycal_tempdelta=255
nvram set pci/1/1/temps_period=15
nvram set pci/1/1/temps_hysteresis=15
nvram set pci/1/1/measpower1=0x7f
nvram set pci/1/1/measpower2=0x7f
nvram set pci/1/1/pdoffset40ma0=0
nvram set pci/1/1/pdoffset40ma1=0
nvram set pci/1/1/pdoffset40ma2=0
nvram set pci/1/1/pdoffset80ma0=0
nvram set pci/1/1/pdoffset80ma1=0
nvram set pci/1/1/pdoffset80ma2=0
nvram set pci/1/1/subband5gver=0x4
nvram set pci/1/1/cckbw202gpo=0
nvram set pci/1/1/cckbw20ul2gpo=0
nvram set pci/1/1/mcsbw202gpo=0
nvram set pci/1/1/mcsbw402gpo=0
nvram set pci/1/1/dot11agofdmhrbw202gpo=0
nvram set pci/1/1/ofdmlrbw202gpo=0
nvram set pci/1/1/mcsbw205glpo=4286018353
nvram set pci/1/1/mcsbw405glpo=4286018353
nvram set pci/1/1/mcsbw805glpo=4286018353
nvram set pci/1/1/mcsbw1605glpo=0
nvram set pci/1/1/mcsbw205gmpo=4286018353
nvram set pci/1/1/mcsbw405gmpo=4286018353
nvram set pci/1/1/mcsbw805gmpo=4286018353
nvram set pci/1/1/mcsbw1605gmpo=0
nvram set pci/1/1/mcsbw205ghpo=4286018353
nvram set pci/1/1/mcsbw405ghpo=4286018353
nvram set pci/1/1/mcsbw805ghpo=4286018353
nvram set pci/1/1/mcsbw1605ghpo=0
nvram set pci/1/1/mcslr5glpo=0
nvram set pci/1/1/mcslr5gmpo=0
nvram set pci/1/1/mcslr5ghpo=0
nvram set pci/1/1/sb20in40hrrpo=0
nvram set pci/1/1/sb20in80and160hr5glpo=0
nvram set pci/1/1/sb40and80hr5glpo=0
nvram set pci/1/1/sb20in80and160hr5gmpo=0
nvram set pci/1/1/sb40and80hr5gmpo=0
nvram set pci/1/1/sb20in80and160hr5ghpo=0
nvram set pci/1/1/sb40and80hr5ghpo=0
nvram set pci/1/1/sb20in40lrpo=0
nvram set pci/1/1/sb20in80and160lr5glpo=0
nvram set pci/1/1/sb40and80lr5glpo=0
nvram set pci/1/1/sb20in80and160lr5gmpo=0
nvram set pci/1/1/sb40and80lr5gmpo=0
nvram set pci/1/1/sb20in80and160lr5ghpo=0
nvram set pci/1/1/sb40and80lr5ghpo=0
nvram set pci/1/1/dot11agduphrpo=0
nvram set pci/1/1/dot11agduplrpo=0
nvram set pci/1/1/pcieingress_war=15
nvram set pci/1/1/sar2g=18
nvram set pci/1/1/sar5g=15
nvram set pci/1/1/noiselvl2ga0=31
nvram set pci/1/1/noiselvl2ga1=31
nvram set pci/1/1/noiselvl2ga2=31
nvram set pci/1/1/noiselvl5gla0=31
nvram set pci/1/1/noiselvl5gla1=31
nvram set pci/1/1/noiselvl5gla2=31
nvram set pci/1/1/noiselvl5gma0=31
nvram set pci/1/1/noiselvl5gma1=31
nvram set pci/1/1/noiselvl5gma2=31
nvram set pci/1/1/noiselvl5gha0=31
nvram set pci/1/1/noiselvl5gha1=31
nvram set pci/1/1/noiselvl5gha2=31
nvram set pci/1/1/noiselvl5gua0=31
nvram set pci/1/1/noiselvl5gua1=31
nvram set pci/1/1/noiselvl5gua2=31
nvram set pci/1/1/rxgainerr2g=0xffff
nvram set pci/1/1/rxgainerr5g=0xffff,0xffff,0xffff,0xffff
nvram set pci/1/1/maxp2ga0=76
nvram set pci/1/1/pa2ga0=0xfe72,0x14c0,0xfac7
nvram set pci/1/1/rxgains5gmelnagaina0=2
nvram set pci/1/1/rxgains5gmtrisoa0=5
nvram set pci/1/1/rxgains5gmtrelnabypa0=1
nvram set pci/1/1/rxgains5ghelnagaina0=2
nvram set pci/1/1/rxgains5ghtrisoa0=5
nvram set pci/1/1/rxgains5ghtrelnabypa0=1
nvram set pci/1/1/rxgains2gelnagaina0=0
nvram set pci/1/1/rxgains2gtrisoa0=0
nvram set pci/1/1/rxgains2gtrelnabypa0=0
nvram set pci/1/1/rxgains5gelnagaina0=1
nvram set pci/1/1/rxgains5gtrisoa0=7
nvram set pci/1/1/rxgains5gtrelnabypa0=1
nvram set pci/1/1/maxp5ga0=92,92,92,92
nvram set pci/1/1/pa5ga0=0xff26,0x188e,0xfcf0,0xff2a,0x18ee,0xfcec,0xff21,0x18b4,0xfcec,0xff23,0x1930,0xfcdd
nvram set pci/1/1/maxp2ga1=76
nvram set pci/1/1/pa2ga1=0xfe80,0x1472,0xfabc
nvram set pci/1/1/rxgains5gmelnagaina1=2
nvram set pci/1/1/rxgains5gmtrisoa1=4
nvram set pci/1/1/rxgains5gmtrelnabypa1=1
nvram set pci/1/1/rxgains5ghelnagaina1=2
nvram set pci/1/1/rxgains5ghtrisoa1=4
nvram set pci/1/1/rxgains5ghtrelnabypa1=1
nvram set pci/1/1/rxgains2gelnagaina1=0
nvram set pci/1/1/rxgains2gtrisoa1=0
nvram set pci/1/1/rxgains2gtrelnabypa1=0
nvram set pci/1/1/rxgains5gelnagaina1=1
nvram set pci/1/1/rxgains5gtrisoa1=6
nvram set pci/1/1/rxgains5gtrelnabypa1=1
nvram set pci/1/1/maxp5ga1=92,92,92,92
nvram set pci/1/1/pa5ga1=0xff35,0x1a3c,0xfccc,0xff31,0x1a06,0xfccf,0xff2b,0x1a54,0xfcc5,0xff30,0x1ad5,0xfcb9
nvram set pci/1/1/maxp2ga2=76
nvram set pci/1/1/pa2ga2=0xfe82,0x14bf,0xfad9
nvram set pci/1/1/rxgains5gmelnagaina2=3
nvram set pci/1/1/rxgains5gmtrisoa2=4
nvram set pci/1/1/rxgains5gmtrelnabypa2=1
nvram set pci/1/1/rxgains5ghelnagaina2=3
nvram set pci/1/1/rxgains5ghtrisoa2=4
nvram set pci/1/1/rxgains5ghtrelnabypa2=1
nvram set pci/1/1/rxgains2gelnagaina2=0
nvram set pci/1/1/rxgains2gtrisoa2=0
nvram set pci/1/1/rxgains2gtrelnabypa2=0
nvram set pci/1/1/rxgains5gelnagaina2=1
nvram set pci/1/1/rxgains5gtrisoa2=5
nvram set pci/1/1/rxgains5gtrelnabypa2=1
nvram set pci/1/1/maxp5ga2=92,92,92,92
nvram set pci/1/1/pa5ga2=0xff2e,0x197b,0xfcd8,0xff2d,0x196e,0xfcdc,0xff30,0x1a7d,0xfcc2,0xff2e,0x1ac6,0xfcb4

#we only insert wifi modules in init. 
xmldbc -P /etc/services/WIFI/init_wifi_mod.php >> /var/init_wifi_mod.sh
chmod +x /var/init_wifi_mod.sh
/bin/sh /var/init_wifi_mod.sh

#initial wifi interfaces
service PHYINF.WIFI start
